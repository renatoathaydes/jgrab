import java.util.regex.Pattern

allprojects {
    group = 'com.athaydes.jgrab'
    version = '2.1.0'
}

tasks.register( 'cargoBuild', Exec ) {
    dependsOn ':jgrab-runner:fatJar'
    workingDir file( 'jgrab-client' )
    commandLine 'cargo', 'build', '--release'
}

tasks.register( 'testJGrabClient', Exec ) {
    dependsOn 'cargoBuild'
    workingDir file( 'jgrab-client' )
    commandLine './test.sh'
}

tasks.register( 'build' ) {
    dependsOn ':jgrab-runner:fatJar', 'cargoBuild', 'testJGrabClient'
}
